<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>スクールバス乗車受付</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rossorigin="anonymous">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-datetimepicker@2.5.20/jquery.datetimepicker.css">
    </head>
    <body>

        <form class="w-75 mx-auto">
            <p class="mt-3">ID</p>
            <div>
                <input class="form-control w-100 mt-1" name=date value="" required>
            </div>
            <p class="mt-3">学校名</p>
            <div>
                <!-- <input class="form-control w-100 mt-1" name="school" placeholder="羽村特別支援学校" required> -->
                <select id="school" name="school">
                    <option value="" selected>学校名
                    <option value="hamura">羽村特別支援学校
                    <option value="akiruno">あきる野学園
                    <option value="hachiojinishi">八王子西特別支援学校
                    <option value="nanao">七生特別支援学校
                    <option value="seiho">青峰学園
                    <option value="hachiojimo">八王子盲学校
                    <option value="murayama">村山特別支援学校
                    <option value="musashidai">武蔵台学園
                    <option value="tanashi">田無特別支援学校
                    <option value="kiyose">清瀬特別支援学校
                    <option value="tachikawa">立川学園
                    <option value="koganei">小金井特別支援学校
                    <option value="kodaira">小平特別支援学校
                    <option value="komei">光明学園
                </select>
            <!-- </div> -->
                <p class="mt-3">コース名</p>
            <!-- <div> -->
                <!-- <input class="form-control w-100 mt-1" name="course" placeholder="旧青梅コース" required> -->
                <select id="course" name="course">
                    <option value="">学校名を選択してください</option>
                </select>
                <!--Javascript--->
                <script>
                    var array = new Array();
                    array[''] = new Array({cd:"1", label:"学校名を選択してください"});
                    array["hachiojinishi"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"陣馬コース"},
                    {cd:"3", label:"石川コース"},
                    {cd:"4", label:"川口コース"},
                    {cd:"5", label:"大和田コース"}
                    );
                    array["akiruno"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"東中神コース"},
                    {cd:"3", label:"檜原コース"},
                    {cd:"4", label:"昭島コース"},
                    {cd:"5", label:"新五日市コース"},
                    {cd:"6", label:"拝島コース"},
                    {cd:"7", label:"武蔵増戸コース"},
                    {cd:"8", label:"急行檜原コース"}
                    );
                    array["nanao"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"日野駅コース"},
                    {cd:"3", label:"万願寺コース"}
                    );
                    array["seiho"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"西コース"},
                    {cd:"3", label:"二俣尾コース"}
                    );
                    array["hachiojimo"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"昭島コース"}
                    );
                    array["hamura"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"旧青梅コース"},
                    {cd:"3", label:"友愛コース"},
                    {cd:"4", label:"成木コース"},
                    {cd:"5", label:"東大和コース"},
                    {cd:"6", label:"羽村コース"},
                    {cd:"7", label:"武蔵村山コース"},
                    {cd:"8", label:"御岳コース"},
                    {cd:"9", label:"奥多摩コース"},
                    {cd:"10", label:"青梅コース"},
                    {cd:"11", label:"立川コース"},
                    {cd:"12", label:"新青梅街道コース"},
                    {cd:"13", label:"福生コース"}
                    );
                    array["murayama"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"立川諏訪コース"},
                    {cd:"3", label:"青梅橋コース"},
                    {cd:"4", label:"昭和公園コース"},
                    {cd:"5", label:"江戸街道コース"},
                    {cd:"6", label:"多摩川コース"},
                    {cd:"7", label:"モノレールコース"}
                    );
                    array["musashidai"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"国立コース"},
                    {cd:"3", label:"立川南コース"}
                    );
                    array["tanashi"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"西東京コース"},
                    {cd:"3", label:"小平コース"}
                    );
                    array["kiyose"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"富士見町コース"},
                    {cd:"3", label:"東村山コース"}
                    );
                    array["tachikawa"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"西砂コース"}
                    );
                    array["koganei"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"小平コース"}
                    );
                    array["kodaira"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"こぶしコース"}
                    );
                    array["komei"] = new Array(
                    {cd:"1", label:"コース名"},
                    {cd:"2", label:"仙川コース"}
                    );
        
                    document.getElementById('school').onchange = function(){
                    cource = document.getElementById("cource");
                    cource.options.length = 0
                    var changedPref = school.value;
                    for (let i = 0; i < array[changedPref].length; i++) {
                        var op = document.createElement("option");
                        value = array[changedPref][i]
                        op.value = value.cd;
                        op.text = value.label;
                        cource.appendChild(op);
                    }}
                </script>
                <!-------------->
            </div>
            <p class="mt-3">名前</p>
            <div>
                <input class="form-control w-100 mt-1" name="name" placeholder="" required>
            </div>
            <p class="mt-3">いつから？</p>
            <div>
                <!-- <input class="form-control w-100 mt-1" name="dateFrom" placeholder="" required> -->
                <input class="datetimepicker" type="text" name="dateFrom" placeholder="" required>
            </div>
            <p class="mt-3">いつまで？</p>
            <div>
                <!-- <input class="form-control w-100 mt-1" name="dateTo" placeholder="" required> -->
                <input class="datetimepicker" type="text" name="dateTo" placeholder="" required>
            </div>
            <p class="mt-3">登校便</p>
            <div>
                <input class="form-control w-100 mt-1" name="toko" placeholder="" required>
            </div>
            <p class="mt-3">下校便</p>
            <div>
                <input class="form-control w-100 mt-1" name="geko" required>
            </div>
            <p class="mt-3">休み？</p>
            <div>
                <input class="form-control w-100 mt-1" name="absence" required>
            </div>
            <p class="mt-3">備考</p>
            <div>
                <input class="form-control w-100 mt-1" name="biko" required>
            </div>
            <input type="submit" class="mt-4 btn btn-primary" value="送信">
        </form>

        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
        <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery-datetimepicker@2.5.20/build/jquery.datetimepicker.full.min.js"></script>
        <script>

            $(document).ready(function () {
                const liffId = "1657192970-L5pw3bd6";
                initializeLiff(liffId);
            })

            function initializeLiff(liffId) {
                liff.init({
                    liffId: liffId
                }).then(() => {
                    initializeApp();
                }).catch((err) => {
                    console.log('LIFF Initialization failed ', err);
                });
            }

            function sendText(text) {
                liff.sendMessages([{
                    'type': 'text',
                    'text': text
                }]).then(function () {
                    liff.closeWindow();
                }).catch(function (error) {
                    window.alert('Failed to send message ' + error);
                });
            }

            const params = (new URL(document.location)).searchParams;
            const key = params.get('key');

            $(function () {
                $('form').submit(function () {
                    const id       = $('input[name="id"]').val();
                    const school   = $('input[name="school"]').val();
                    const course   = $('input[name="course"]').val();
                    const name     = $('input[name="name"]').val();
                    const dateFrom = $('input[name="dateFrom"]').val();
                    const dateTo   = $('input[name="dateTo"]').val();
                    const toko     = $('input[name="toko"]').val();
                    const geko     = $('input[name="geko"]').val();
                    const absence  = $('input[name="absence"]').val();
                    const biko     = $('input[name="biko"]').val();
                    const msg = `${id}\n${school}\n${course}\n${name}\n${dateFrom}\n${dateTo}\n${toko}\n${geko}\n${absence}\n${biko}`;
                    sendText(msg);
                    return false;
                });
            });

        </script>
        <script>
            $('.datetimepicker').datetimepicker({
              timepicker:false,
              format: 'Y/m/d'
            });
        </script>

    </body>
</html>